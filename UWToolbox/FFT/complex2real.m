function [Y,t] = complex2real(F, t)% [Y,t] = complex2real(F, t)%% Returns the real-valued amplitudes and phases in a structure calculated% from the complex-valued vector 'F' having the convention of MATLAB's % fft.m output.% % This is the inverse of the function 'real2complex.m'.%% Inputs:%   F            Complex-valued vector in the convention of fft's output.%                (i.e., fft(y); see FFT.m)%%   t            Time vector of size y (default: 1:length(F) )%% Outputs:   %   Y            A structure with fields:%       dc       Mean value of 'y' time series%       ph       Vector of phases (in degrees, cosine phase)%       amp      Vector of amplitudes of length ceil(length(t)/2)%       freq     Vector of frequencies available in 'y', maximum frequency%                determined by the Nyquist Limit (nt/2)%       nt       Length of t (required for real2complex.m)%%   t            Time vector of size y, if not previously provided%% Example:% t = 0:0.01:0.99;% y = t < 0.5; % Y = complex2real(fft(y), t);% figure(1); clf;% subplot(1,2,1); % stem(t,y);% xlabel('Time (s)');% % subplot(1,2,2); % stem(Y.freq, Y.amp);% xlabel('Frequency (Hz)');% ylabel('Amplitude');% Written by G.M. Boynton at the University of Washington - 4/15/09% Edited by Kelly Chang - November 29, 2017%% Input Controlif ~exist('t', 'var') || isempty(t)    t = 1:length(F);end%% Transform Signal 'y' into Fourier Components% calculate values based on tY.nt = length(t);dt = t(2) - t(1);id = 2:(ceil(Y.nt/2)+1); % omitting 'negative' frequencies% DC is first value scaled by nt, 'zero' frequencyY.dc = F(1) / Y.nt;% 'real' amplitudes (real component) scale the fft by 2/ntamp = 2 * abs(F) / Y.nt;Y.amp = amp(id);% 'real' phases are reversed (and converted to degrees)ph = -180 * angle(F) / pi;Y.ph = ph(id); % cosine phase% calculate frequency valuesY.freq = (1:length(id)) / (Y.nt * dt);if mod(Y.nt,2) == 1 %length is odd    Y.amp(end) = 0;else % even    Y.amp(end) = Y.amp(end) / 2;endY = orderfields(Y, {'dc', 'ph', 'amp', 'freq', 'nt'});